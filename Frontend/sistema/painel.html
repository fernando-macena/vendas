<!DOCTYPE html>
<html>
<head>
	<title>Painel administrativo</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="../css/painel.css">

	<script type="text/javascript">
		function mostrarMenuOpcoes() {
			let ajax = new XMLHttpRequest()

			ajax.open("GET", "menu_opcoes.html", true)
			ajax.send()

			ajax.onreadystatechange = () => {
				if(ajax.readyState == 4 && ajax.status == 200) {
					var container = document.getElementById("conteudo-esquerda")
					container.innerHTML = ajax.responseText

					//Lógica para inserir o Script da página HTMl parcial ao DOM dessa página
					
					var script = container.querySelector('script[src]'); //Pegando o script da pagina solicitada atraves do ajax

					var newScript = document.createElement('script');//Criando um elemento script para que o navegador execute

					newScript.src = script.src; //Atribuindo o conteudo script que está sendo tratado como texto ao novo que rodará
					document.body.appendChild(newScript); //Atribuindo o novo script a página
					
				}
			}
		}

		function mostrarDialogPainel(conteudo) {
			var dialogo = document.getElementById("dialog-painel")
			var divConteudo = document.getElementById("conteudo-dialog")
			
			if(conteudo != null) {


				divConteudo.innerHTML = "" //Para remover o conteudo antigo
				divConteudo.append(conteudo.cloneNode(true)) //Se não clonar, o append adiciona null
			} else {
				divConteudo.innerHTML = "Componente sem conteudo!"
			}

			dialogo.showModal()
		}

		
	</script>
</head>
<body>
	<div id=conteudo>
		<dialog id="dialog-painel" class="menu-dialog">
			<button id="sair" onclick="document.getElementById('dialog-painel').close()">
				X				
			</button>

			<div id="conteudo-dialog">	
			</div>
		</dialog>

		<div id="lateral-esquerda">
			<div id="cabecalho-esquerda">
				<img src="../img/painel/PanelLogo.svg">
				<hr>
			</div>

			<div id="conteudo-esquerda">
				Carregando...
				<script>
					document.addEventListener('DOMContentLoaded', mostrarMenuOpcoes)
				</script>
			</div>
		</div> <!-- fim lateral esquerda -->

		<div id="lateral-direita">
			<div id="cabecalho-direita">			
				<div id="avatar" onclick="mostrarDialogPainel(document.getElementById('cadastro-usuario'))">
					<!-- Imagem de perfil -->
					<img id="imagem-perfil">
				</div>

				<div style="display: none">
					<div id="cadastro-usuario">
						<p>Nome: </p>
						<p>Tipo: </p>
					</div>
				</div>
			</div>
			<div id="conteudo-direita">
				<iframe src="produtos.html" id="iframeProdutos"></iframe>
			</div>
		</div> <!-- Fim lateral direita -->
	</div>
</body>
</html>